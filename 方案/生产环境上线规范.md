**生产环境上线规范v1**

本规范暂只适用于在生产环境线上的相关变更操作，由运维人员发起，协调产品/项目、研发、测试人员沟通一致，共同遵守。

生产环境包括以下环境：

- bitahub 生产环境 [www.bitahub.com](http://www.bitahub.com)
- 算法环境 http://10.0.100.210/console/
- 发版环境
- 各个交付项目生产环境

生产环境需谨慎对待，非运维人员禁止对生产环境做任何变更操作。

**上线需求等级**

运维根据上线复杂程度将上线需求划分为以下两级：

- M 级，分钟级上线，（运维侧变更操作对线上环境影响可以控制在十分钟之内，不包含测试等其他事项时间）；
-  H 级，小时级上线，（运维侧变更操作对线上环境影响超过十分钟）。

通常按如下情况划分：

- 上线内容涉及数据库变动时，更新内容确定为 H 级上线；
- 上线内容只有少部分 nacos 配置变动、部署配置变动、应用镜像更新， 且对平台使用影响可忽略时，上线需等级确定为 M ，否则为 H 级。

上述对于“分钟”、“小时”的引用概指在生产环境上进行变更的时间，不包括运维前期准备的时间，上线时间提前沟通是为给运维人员留下足够准备时间。

**上线时间规范**

每次上线流程发起前，请上线需求发起人先确定好变更内容，再和运维人员确定上线需求等级，协调上线时间，具体上线时间需满足下述要求：

-  M 级 上线需求， 至少提前 1 个工昨日 安排确定上线时间，提测流程至少在上线时间点前 0.5 个工昨日 通过，且提测流程通过后不再有 上线变更内容 的改动，否则本次上线终止；
-  H 级 上线需求， 至少提前 2 个工昨日 安排确定上线时间，提测流程至少在上线时间点前 1.5 个工昨日 通过，且提测流程通过后不再有 上线变更内容 的改动，否则本次上线终止；

上线变更内容，上线需求等级，上线时间经相关人员确认一致好，由上线需求发起人发起上线流程。

**上线变更内容规范 （发版内容遵守同样规范）**

上线变更内容需要包含以下内容：

- 本次上线产品/项目负责人员，研发负责人员，测试负责人员，运维负责人员；
- 本次上线具体的变更内容（涉及哪些应用变更、配置配更，以及其他变更操作）；对于同一个上线过程中存在的二次上线操作（如再次更改配置，更新镜像等）需再发邮件说明变更内容并附上相关禅道 bug 记录。